{{ 'gsap-carousel.css' | asset_url | stylesheet_tag }}
<script src="{{ 'gsap-carousel.js' | asset_url }}" defer></script>

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  #GsapSlider-{{ section.id }} {
    height: {{ section.settings.mobile_height }}px;
  }

  @media screen and (min-width: 750px) {
    #GsapSlider-{{ section.id }} {
      height: {{ section.settings.desktop_height }}px;
    }
  }
{%- endstyle -%}

<div class="gsap-carousel-section section-{{ section.id }}-padding">
  <div class="gsap-carousel-wrapper" id="GsapSlider-{{ section.id }}">

    <!-- Navigation Arrows -->
    {% if section.blocks.size > 1 %}
      <div class="gsap-nav prev-btn" aria-label="Previous Slide">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"><path d="M15 18l-6-6 6-6" /></svg>
      </div>
      <div class="gsap-nav next-btn" aria-label="Next Slide">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"><path d="M9 18l6-6-6-6" /></svg>
      </div>
    {% endif %}

    <!-- Slides Container -->
    <div class="gsap-slides-container">
      {%- for block in section.blocks -%}
        <div
          class="gsap-slide {% if forloop.first %}active{% endif %}"
          data-index="{{ forloop.index0 }}"
          {{ block.shopify_attributes }}>

          <!-- Image -->
          <div class="gsap-slide-image-wrapper">
            {%- if block.settings.image != blank -%}
              {%- assign height = section.settings.desktop_height -%}
              {{ block.settings.image | image_url: width: 3840 | image_tag: loading: 'lazy', widths: '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840', class: 'gsap-slide-img', alt: block.settings.heading
              }}
            {%- else -%}
              {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg gsap-slide-img' }}
            {%- endif -%}
            <!-- Overlay -->
            <div class="gsap-overlay" style="background: rgba(0,0,0, {{ block.settings.overlay_opacity | divided_by: 100.0 }})"></div>
          </div>

          <!-- Content -->
          <div class="gsap-slide-content page-width text-{{ block.settings.text_alignment }}">
            <div class="gsap-content-inner">
              {%- if block.settings.subheading != blank -%}
                <p class="gsap-subtitle">{{ block.settings.subheading }}</p>
              {%- endif -%}
              {%- if block.settings.heading != blank -%}
                <h2 class="gsap-title h1">{{ block.settings.heading }}</h2>
              {%- endif -%}
              {%- if block.settings.text != blank -%}
                <div class="gsap-desc rte">{{ block.settings.text }}</div>
              {%- endif -%}
              {%- if block.settings.button_label != blank -%}
                <div class="gsap-btn-wrapper">
                  <a href="{{ block.settings.button_link }}" class="button button--primary">
                    {{ block.settings.button_label }}
                  </a>
                </div>
              {%- endif -%}
            </div>
          </div>
        </div>
      {%- endfor -%}
    </div>

    <!-- Dots -->
    {% if section.blocks.size > 1 %}
      <div class="gsap-dots">
        {%- for block in section.blocks -%}
          <button
            class="gsap-dot {% if forloop.first %}active{% endif %}"
            data-index="{{ forloop.index0 }}"
            aria-label="Go to slide {{ forloop.index }}"></button>
        {%- endfor -%}
      </div>
    {% endif %}

  </div>
</div>

{% schema %}
  {
    "name": "GSAP Animated Slider",
    "tag": "section",
    "class": "section",
    "settings": [
      {
        "type": "header",
        "content": "Dimensions"
      },
      {
        "type": "range",
        "id": "desktop_height",
        "min": 400,
        "max": 900,
        "step": 10,
        "unit": "px",
        "label": "Desktop Height",
        "default": 650
      },
      {
        "type": "range",
        "id": "mobile_height",
        "min": 300,
        "max": 600,
        "step": 10,
        "unit": "px",
        "label": "Mobile Height",
        "default": 400
      },
      {
        "type": "checkbox",
        "id": "autoplay",
        "label": "Enable Autoplay",
        "default": true
      },
      {
        "type": "range",
        "id": "autoplay_speed",
        "min": 3,
        "max": 10,
        "step": 1,
        "unit": "s",
        "label": "Autoplay Speed",
        "default": 5
      },
      {
        "type": "header",
        "content": "Section Padding"
      },
      {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Top Padding",
        "default": 0
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Bottom Padding",
        "default": 0
      }
    ],
    "blocks": [
      {
        "type": "slide",
        "name": "Slide",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "range",
            "id": "overlay_opacity",
            "min": 0,
            "max": 90,
            "step": 5,
            "unit": "%",
            "label": "Overlay Opacity",
            "default": 20
          },
          {
            "type": "text",
            "id": "subheading",
            "label": "Subheading",
            "default": "Welcome to our store"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "New Collection"
          },
          {
            "type": "textarea",
            "id": "text",
            "label": "Description",
            "default": "Pair text with an image to focus on your chosen product, collection, or blog post."
          },
          {
            "type": "select",
            "id": "text_alignment",
            "label": "Text Alignment",
            "options": [
              {
                "value": "left",
                "label": "Left"
              },
              {
                "value": "center",
                "label": "Center"
              },
              {
                "value": "right",
                "label": "Right"
              }
            ],
            "default": "center"
          },
          {
            "type": "text",
            "id": "button_label",
            "label": "Button Label",
            "default": "Shop Now"
          },
          {
            "type": "url",
            "id": "button_link",
            "label": "Button Link"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "GSAP Animated Slider",
        "blocks": [
          {
            "type": "slide"
          },
          {
            "type": "slide"
          }
        ]
      }
    ]
  }
{% endschema %}